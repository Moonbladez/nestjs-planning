generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Assignment {
  id      Int    @id @default(autoincrement())
  startTime DateTime @db.Timestamp(6)
  endTime   DateTime @db.Timestamp(6)
  orderId Int?
  order   Order? @relation(fields: [orderId], references: [id])

  type   ASSIGNMENT_TYPE?
  status ASSIGNMENT_STATUS @default(UnderPlanning)

  fromProjectId Int?
  fromProject   Project? @relation("FromProject", fields: [fromProjectId], references: [id])
  toProjectId   Int?
  toProject     Project? @relation("ToProject", fields: [toProjectId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Order {
  id               Int           @id @default(autoincrement())
  status           ORDER_STATUS  @default(Created) @map("status")
  type             ORDER_TYPE
  earlyDelivery    Boolean       @map("early_delivery")
  date             DateTime      @db.Timestamp(6)
  vehicleType      VEHICLE_TYPE? @map("vehicle_type")
  numberOfVehicles Int?

  fromProjectId Int?
  toProjectId   Int?
  fromProject   Project? @relation("FromProject", fields: [fromProjectId], references: [id])
  toProject     Project? @relation("ToProject", fields: [toProjectId], references: [id])

  whenId Int?
  when   When? @relation(fields: [whenId], references: [id])

  createdAt  DateTime     @default(now())
  updatedAt  DateTime     @updatedAt
  Assignment Assignment[]
}

model Project {
  id         Int     @id @default(autoincrement())
  name       String
  region     Int?
  latitude   String?
  longitude  String?
  fromOrders Order[] @relation("FromProject")
  toOrders   Order[] @relation("ToProject")

  fromAssignments Assignment[] @relation("FromProject")
  toAssignments   Assignment[] @relation("ToProject")
  
}

model When {
  id     Int       @id @default(autoincrement())
  from   String?
  to     String?
  type   WHEN_TYPE
  orders Order[]
}

model Vehicle {
  internalNumber Int @id @default(autoincrement())
  registration   String
  manufacturer   String?
  mainCategory   String?
  subCategory    String?
  modelYear      String?
  modelName     String?
  statusName   String?
  driver         Driver?  @relation(fields: [driverId], references: [id])
  driverId       Int? @unique
}

model Driver {
  id  Int     @id @default(autoincrement()) @unique
  name String
  vehicle Vehicle?
}

enum ASSIGNMENT_TYPE {
  MassIn
  MassOut
  MassInternal
  ContainerDeliver
  ContainerCollect
  ContainerEmptying
  ContainerSwap
}

enum ASSIGNMENT_STATUS {
  UnderPlanning
  Approved
  Started
  Completed
  NotDelivered
  Cancelled
  Deleted
  VerifiedNotDelivered
  Unavailable
  Suggested
  SuggestedAndApproved
}

enum VEHICLE_TYPE {
  Single
  Double
  Semi
  CarWithTrailer
  SixxSix
  HookLift
}

enum ORDER_STATUS {
  Created
  UnderPlanning
  Planned
  Cancelled
  Declined
}

enum ORDER_TYPE {
  MassIn
  MassOut
  MassInternal
  ContainerDeliver
  ContainerCollect
  ContainerEmptying
}

enum WHEN_TYPE {
  DuringTheDay
  Morning
  BeforeFood
  AfterFood
  Custom
}
